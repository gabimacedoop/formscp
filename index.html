<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ANÁLISE DE COLORAÇÃO PESSOAL (ONLINE) - @gabrielamacedocores</title><style>
    /* Fonte Inter offline: usa apenas fontes locais, sem chamadas de rede */
    @font-face {
      font-family: 'Inter';
      src: local('Inter'), local('Inter Regular'), local('InterVariable');
      font-weight: 100 900;
      font-style: normal;
      font-display: swap;
    }
:root {
      --bg: #ffffff;
      --fg: #222222;
      --muted: #666666;
      --border: #e5e5e5;
      /* Cores */
      --accent: #25D366;
      --header-bg: #ce417d;
      --error: #e53935;
      --gosta-color: #2e7d32;

      --maxw: 720px;
      --radius: 16px;
      /* Tipografia */
      --fs-title: 20px;
      --fs-subtitle: 20px;
      --fs-question: 17.5px;
      --fs-text: 15px;
      --fs-caption: 12.5px;
    }

    html, body {
      margin: 0;
      font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
      background: var(--bg);
      color: var(--fg);
      -webkit-font-smoothing: antialiased;
      text-rendering: optimizeLegibility;
      line-height: 1.2;
    }
    body {
      margin: 0;
      font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
      background: var(--bg);
      color: var(--fg);
      -webkit-font-smoothing: antialiased;
      text-rendering: optimizeLegibility;
    }

    .container {
      max-width: var(--maxw);
      margin: 0 auto;
      padding: 24px 16px 64px;
    }
    main.container {
        padding-top: 20px;
    }
    
    /* Estilo do Cabeçalho Rosa */
    .main-header-wrapper {
        background-color: var(--header-bg);
        color: white;
        margin: -24px -16px 28px -16px;
        padding: 24px 16px;
        text-align: center; /* Centralizado */
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
    }
     .main-header-wrapper header {
        max-width: var(--maxw);
        width: 100%;
        padding: 0; /* Remove padding extra do container */
    }
    .main-header-wrapper .title {
        color: white;
        font-weight: 700; /* bold */
        font-size: var(--fs-title);
    }
    .main-header-wrapper .lead {
        color: rgba(255, 255, 255, 0.9);
        font-size: 12.5px;
        max-width: 600px; /* Limita a largura para melhor leitura */
        margin: 6px auto 0; /* Centraliza */
        line-height: 1.2;
    }

    .card {
      background: transparent;
      border: none;
      border-radius: 0;
      padding: 0;
      box-shadow: none;
    }

    .subtitle {
      font-size: var(--fs-subtitle);
      font-weight: 900; /* super bold */
      text-transform: uppercase;
      line-height: 1.2;
      margin: 0 0 8px 0;
    }

    .field { margin: 20px 0; } 
    .field-spaced { margin: 40px 0; }

    .question {
      display: block;
      font-size: var(--fs-question);
      font-weight: 600;
      margin-bottom: 15px;
    }
    .question .required-asterisk {
        color: var(--error);
        font-weight: bold;
        margin-left: 4px;
    }
    .gosta-label, .nao-gosta-label {
        font-weight: 900;
        text-transform: uppercase;
    }
    .gosta-label { color: var(--gosta-color); }
    .nao-gosta-label { color: var(--error); }
    
    .legend {
      font-size: var(--fs-caption);
      color: var(--muted);
    }
    
    .form-page > .legend {
        margin: -4px 0 20px;
        padding-bottom: 20px; /* Espaçamento para a linha */
        border-bottom: 1px solid var(--border); /* Linha divisória */
    }

    .field > .legend {
        margin: -10px 0 10px;
    }
    
    .field-spaced > .legend {
        margin-bottom: 20px;
    }

    .field-wrapper {
        position: relative;
    }
    
    .field.error-shake {
        animation: shake 0.4s cubic-bezier(.36,.07,.19,.97) both;
    }
    @keyframes shake {
      10%, 90% { transform: translate3d(-1px, 0, 0); }
      20%, 80% { transform: translate3d(2px, 0, 0); }
      30%, 50%, 70% { transform: translate3d(-4px, 0, 0); }
      40%, 60% { transform: translate3d(4px, 0, 0); }
    }


    input[type="text"], input[type="email"], input[type="tel"], textarea, select {
      width: 100%;
      font: inherit;
      font-size: var(--fs-text);
      color: var(--fg);
      background: #fff;
      border: 1px solid var(--border);
      border-radius: 2.5px;
      padding: 10px;
      outline: none;
      transition: box-shadow .2s, border-color .2s;
      box-sizing: border-box;
    }
    textarea {
        height: 50px;
    }

    input::placeholder, textarea::placeholder {
        color: #9aa0a6;
        font-size: 12.5px;
    }
    
    input:focus, textarea:focus, select:focus {
      border-color: var(--accent);
      box-shadow: none;
    }
    
    .validation-icon {
        position: absolute;
        top: 50%;
        right: 12px;
        transform: translateY(-50%);
        font-size: 18px;
        opacity: 0;
        transition: opacity .2s;
    }
    .field-wrapper.valid .validation-icon::after { content: '✔'; color: var(--accent); }
    .field-wrapper.invalid .validation-icon::after { content: '✖'; color: var(--error); }
    .field-wrapper.valid .validation-icon, .field-wrapper.invalid .validation-icon { opacity: 1; }
    input.is-valid:focus { border-color: var(--accent); box-shadow: none; }
    input.is-invalid { border-color: var(--error); }
    input.is-invalid:focus { border-color: var(--error); box-shadow: none; }

    .options { 
      display: grid; 
      gap: 0;
      margin-top: 4px;
    }

    .option {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 4px 0;
      cursor: pointer;
    }
    .option input { width: 18px; height: 18px; flex-shrink: 0; }
    .option span { font-size: var(--fs-text); }

    .actions { display: flex; gap: 10px; flex-wrap: wrap; align-items: center; margin-top: 24px; }

    .primary {
      appearance: none; -webkit-appearance: none; border: none; background: var(--accent); color: #fff; font-weight: 700; font-size: var(--fs-caption); padding: 12px 16px; border-radius: 2.5px; cursor: pointer; transition: transform .02s, background-color .15s, opacity .2s; text-decoration: none; display: inline-flex; align-items: center; justify-content: center;
      min-height: 48px;
      text-transform: uppercase;
    }
    .primary:hover { background-color: color-mix(in srgb, var(--accent) 85%, black); }
    .primary:active { transform: translateY(1px); }
    .primary[disabled] { opacity: .6; cursor: not-allowed; background-color: var(--accent); }

    .outline { background: #fff; color: var(--fg); border: 1px solid var(--border); font-weight: 700; }
    .outline:hover { background-color: #f5f5f5; }
    .link { background: transparent; border: none; color: var(--fg); padding: 8px 0; cursor: pointer; text-decoration: underline; font-size: var(--fs-text); font-weight: 700; }
    .success { color: #0a7d26; }
    .hidden { display: none; }

    pre { white-space: pre-wrap; word-wrap: break-word; background: #fafafa; border: 1px solid var(--border); border-radius: 2.5px; padding: 12px; font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace; font-size: 14px; margin-top: 6px; }
    
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    .form-page { animation: fadeIn .4s ease-out forwards; }
    
    .spinner { width: 20px; height: 20px; border: 3px solid rgba(255, 255, 255, 0.4); border-top-color: #fff; border-radius: 50%; animation: spin .8s linear infinite; }
    @keyframes spin { to { transform: rotate(360deg); } }
    #copyMsg.fade-out { animation: fadeOut 3s forwards ease-in-out; }
    @keyframes fadeOut { 0%, 80% { opacity: 1; } 100% { opacity: 0; } }
    #saveStatus { transition: opacity .5s ease-in-out; opacity: 0; }
    
    .image-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; margin-top: 4px; }
    .image-option-label { display: flex; flex-direction: column; cursor: pointer; text-align: center; }
    .image-option-label input[type="radio"], .image-option-label input[type="checkbox"] { display: none; }
    .image-option-content { position: relative; border: 2px solid var(--border); border-radius: 2.5px; overflow: hidden; transition: border-color .2s, box-shadow .2s; padding: 4px; background: #fafafa; }
    .image-option-label:hover .image-option-content { border-color: color-mix(in srgb, var(--accent) 50%, transparent); }
    
    .image-option-content .color-swatch {
        width: 100%;
        border-radius: 2.5px;
        aspect-ratio: 1 / 1;
    }
    .image-option-content img { display: block; width: 100%; border-radius: 2.5px; aspect-ratio: 1 / 1; object-fit: cover; }
    .image-option-content img.other-option {
        opacity: 0.5;
    }
    .option-name { 
        font-family: 'Inter', sans-serif;
        color: var(--muted);
        font-size: 10px;
        font-weight: normal;
        padding-top: 8px;
        line-height: 1.2;
        text-transform: uppercase;
    }
    .image-option-label input:checked ~ .image-option-content { border-color: var(--accent); box-shadow: none; }
    .image-option-label input:checked ~ .image-option-content::after { 
        content: '';
        position: absolute;
        top: 8px;
        right: 8px;
        width: 24px;
        height: 24px;
        background-color: var(--accent);
        background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' fill='white'%3e%3cpath d='M12.207 4.793a1 1 0 010 1.414l-5 5a1 1 0 01-1.414 0l-2-2a1 1 0 011.414-1.414L6.5 9.086l4.293-4.293a1 1 0 011.414 0z'/%3e%3c/svg%3e");
        background-repeat: no-repeat;
        background-position: center;
        background-size: 16px;
        border-radius: 50%;
    }
    .outro-input-container { margin-top: 10px; }

    .progress-bar-container {
        position: relative;
        background-color: #f0f0f0;
        border-radius: 2.5px;
        overflow: hidden;
        margin-bottom: 24px;
        height: 16px;
    }
    .progress-bar {
        width: 25%;
        height: 100%;
        background-color: var(--accent);
        transition: width .3s ease-in-out;
    }
     .progress-text {
        position: absolute;
        width: 100%;
        text-align: center;
        top: 50%;
        left: 0;
        transform: translateY(-50%);
        font-size: 10px;
        font-weight: bold;
        color: var(--fg);
        line-height: 1.2;
        pointer-events: none;
    }
    .navigation-buttons {
        display: flex;
        justify-content: space-between;
        margin-top: 24px;
        border-top: 1px solid var(--border);
        padding-top: 20px;
    }
     .result-buttons {
        display: flex;
        justify-content: space-between;
        gap: 10px;
    }
     .result-buttons .primary {
        min-height: auto;
    }
    .error-message {
        color: var(--error);
        font-size: var(--fs-caption);
        font-weight: 600;
        margin-top: 8px;
    }
    
    /* Novo Estilo do Rodapé */
    .main-footer {
        padding: 32px 16px;
        text-align: center;
        font-size: 10px;
        color: var(--muted);
        border-top: 1px solid var(--border);
        margin-top: 40px;
    }
    .main-footer p {
        margin: 4px 0;
    }

    #resultPage .subtitle, #resultPage .legend {
        text-align: center;
    }
    #resultPage .legend {
        font-size: 15px;
        line-height: 1.2;
    }
    .desktop-break {
        display: none;
    }

    @media (min-width: 820px) {
      .card { padding: 0; }
      .image-grid { grid-template-columns: repeat(5, 1fr); }
      .main-header-wrapper .title { font-size: 30px; }
      .main-header-wrapper { padding: 32px 64px; }
      .desktop-break { display: block; }
    }
  </style>
</head>
<body>
  <div class="main-header-wrapper">
    <header class="container">
      <h1 class="title">ANÁLISE DE COLORAÇÃO PESSOAL (ONLINE)</h1>
      <p class="lead">GABRIELA MACEDO - COLORAÇÃO PESSOAL<br><strong>@gabrielamacedocores</strong></p>
    </header>
  </div>

  <main class="container">
    <!-- PÁGINA 1: FORM -->
    <form id="quizForm" class="card" autocomplete="on" novalidate>
        <!-- BARRA DE PROGRESSO -->
        <div class="progress-bar-container">
            <div id="progressBar" class="progress-bar"></div>
            <div id="progressText" class="progress-text"></div>
        </div>

        <div id="pagesContainer">
            <!-- PÁGINA 1: Dados Pessoais -->
            <div class="form-page" data-page="1">
              <h2 class="subtitle">Dados pessoais</h2>
              <p class="legend">Preencha este formulário com sinceridade e atenção, para que eu possa realizar uma análise detalhada e personalizada.</p>
              <div class="field">
                <label class="question" for="nome">Qual seu nome completo?<span class="required-asterisk">*</span></label>
                <p class="legend">Ou como prefere ser chamada (nome ou apelido).</p>
                <input id="nome" name="nome" type="text" placeholder="Seu nome completo ou apelido" required />
              </div>
              <div class="field">
                <label class="question" for="instagram">Qual o @ do seu Instagram?<span class="required-asterisk">*</span></label>
                <p class="legend">Se seu perfil for privado, me aceite como seguidora durante o processo de análise.</p>
                <div class="field-wrapper">
                  <input id="instagram" name="instagram" type="text" placeholder="@seuinstaaqui" required />
                  <span class="validation-icon"></span>
                </div>
              </div>
              <div class="field">
                <label class="question" for="email">Qual é seu e-mail?<span class="required-asterisk">*</span></label>
                <p class="legend">De preferência da gmail (google).</p>
                 <div class="field-wrapper">
                  <input id="email" name="email" type="email" placeholder="seuemail@exemplo.com" required />
                  <span class="validation-icon"></span>
                </div>
              </div>
              <div class="field">
                <label class="question" for="whatsapp">Qual seu WhatsApp?<span class="required-asterisk">*</span></label>
                <p class="legend">Exemplo: (34) 99861-1525 (apenas números)</p>
                 <div class="field-wrapper">
                  <input id="whatsapp" name="whatsapp" inputmode="numeric" type="tel" placeholder="(XX) XXXXX-XXXX" required maxlength="15" />
                  <span class="validation-icon"></span>
                </div>
              </div>
               <div class="field">
                  <label class="question" for="genero">Com qual gênero você se identifica?<span class="required-asterisk">*</span></label>
                  <select id="genero" name="genero" data-outro-select-target="#outroGenero" required>
                      <option value="" selected disabled>Selecione</option>
                      <option value="Feminino">Feminino</option>
                      <option value="Masculino">Masculino</option>
                      <option value="Não binário">Não binário</option>
                      <option value="Prefiro não dizer">Prefiro não dizer</option>
                      <option value="Outro">Outro</option>
                  </select>
                  <div id="outroGenero" class="outro-input-container hidden">
                      <input type="text" name="genero_outro" placeholder="Por favor, especifique" />
                  </div>
              </div>
              <div class="field">
                <label class="question" for="faixa_etaria">Qual sua faixa etária?<span class="required-asterisk">*</span></label>
                <select id="faixa_etaria" name="faixa_etaria" required>
                  <option value="" selected disabled>Selecione</option>
                  <option>Menos de 18</option>
                  <option>18–24</option>
                  <option>25–34</option>
                  <option>35–44</option>
                  <option>45–54</option>
                  <option>55–64</option>
                  <option>65+</option>
                </select>
              </div>
            </div>
            
            <!-- PÁGINA 2: Sobre Cores -->
            <div class="form-page hidden" data-page="2">
              <h2 class="subtitle">Sobre cores</h2>
              <p class="legend">Conte-nos um pouco sobre as suas preferências.</p>
              <div class="field">
                <span class="question">Você prefere roupas mais discretas ou gosta de ousar nas cores?<span class="required-asterisk">*</span></span>
                <div class="options" role="group">
                  <label class="option"><input type="radio" name="pref_cores_ousadia" value="Discretas, quase sem cores" required /><span>Gosto de roupas discretas, quase não uso cores.</span></label>
                  <label class="option"><input type="radio" name="pref_cores_ousadia" value="Equilíbrio" /><span>Uso cores de forma equilibrada, sem exageros.</span></label>
                  <label class="option"><input type="radio" name="pref_cores_ousadia" value="Cores vivas" /><span>Adoro usar cores vivas e chamativas.</span></label>
                  <label class="option"><input type="radio" name="pref_cores_ousadia" value="Depende da ocasião" /><span>Depende da ocasião.</span></label>
                  <label class="option"><input type="radio" name="pref_cores_ousadia" value="Outro" data-outro-target="#outroCoresOusadia" /><span>Outro</span></label>
                </div>
                <div id="outroCoresOusadia" class="outro-input-container hidden">
                  <input type="text" name="pref_cores_ousadia_outro" placeholder="Por favor, especifique" />
                </div>
              </div>
              <div class="field field-spaced">
                <span class="question">Quais cores você mais <strong class="gosta-label">GOSTA</strong> de usar?<span class="required-asterisk">*</span></span>
                <p class="legend">Ou seja, quais dessas você se sente melhor, você mais encontra em seu guarda roupa?</p>
                <div class="image-grid" role="group" id="gostaGrid">
                    <label class="image-option-label"><input type="checkbox" name="cores_armario" value="Preto"><div class="image-option-content"><div class="color-swatch" style="background-color: #222222;"></div></div><span class="option-name">PRETO</span></label>
                    <label class="image-option-label"><input type="checkbox" name="cores_armario" value="Branco"><div class="image-option-content"><div class="color-swatch" style="background-color: #FFFFFF; border: 1px solid #ddd;"></div></div><span class="option-name">BRANCO</span></label>
                    <label class="image-option-label"><input type="checkbox" name="cores_armario" value="Amarelo Gema"><div class="image-option-content"><div class="color-swatch" style="background-color: #F8D568;"></div></div><span class="option-name">AMARELO GEMA</span></label>
                    <label class="image-option-label"><input type="checkbox" name="cores_armario" value="Amarelo Lima"><div class="image-option-content"><div class="color-swatch" style="background-color: #D4DD4F;"></div></div><span class="option-name">AMARELO LIMA</span></label>
                    <label class="image-option-label"><input type="checkbox" name="cores_armario" value="Amarelo Mostarda"><div class="image-option-content"><div class="color-swatch" style="background-color: #DDAF27;"></div></div><span class="option-name">AMARELO MOSTARDA</span></label>
                    <label class="image-option-label"><input type="checkbox" name="cores_armario" value="Azul Claro (Celeste)"><div class="image-option-content"><div class="color-swatch" style="background-color: #A4C8E2;"></div></div><span class="option-name">AZUL CLARO (CELESTE)</span></label>
                    <label class="image-option-label"><input type="checkbox" name="cores_armario" value="Azul Marinho"><div class="image-option-content"><div class="color-swatch" style="background-color: #2F3E58;"></div></div><span class="option-name">AZUL MARINHO</span></label>
                    <label class="image-option-label"><input type="checkbox" name="cores_armario" value="Azul Royal"><div class="image-option-content"><div class="color-swatch" style="background-color: #3155A3;"></div></div><span class="option-name">AZUL ROYAL</span></label>
                    <label class="image-option-label"><input type="checkbox" name="cores_armario" value="Bege (Areia)"><div class="image-option-content"><div class="color-swatch" style="background-color: #D6C6B2;"></div></div><span class="option-name">BEGE (AREIA)</span></label>
                    <label class="image-option-label"><input type="checkbox" name="cores_armario" value="Cinza"><div class="image-option-content"><div class="color-swatch" style="background-color: #A0A0A0;"></div></div><span class="option-name">CINZA</span></label>
                    <label class="image-option-label"><input type="checkbox" name="cores_armario" value="Laranja"><div class="image-option-content"><div class="color-swatch" style="background-color: #F37A23;"></div></div><span class="option-name">LARANJA</span></label>
                    <label class="image-option-label"><input type="checkbox" name="cores_armario" value="Lilás"><div class="image-option-content"><div class="color-swatch" style="background-color: #C9A9C9;"></div></div><span class="option-name">LILÁS</span></label>
                    <label class="image-option-label"><input type="checkbox" name="cores_armario" value="Marrom (Caramelo)"><div class="image-option-content"><div class="color-swatch" style="background-color: #AF7B46;"></div></div><span class="option-name">MARROM (CARAMELO)</span></label>
                    <label class="image-option-label"><input type="checkbox" name="cores_armario" value="Off White"><div class="image-option-content"><div class="color-swatch" style="background-color: #F3EFE7; border: 1px solid #ddd;"></div></div><span class="option-name">OFF WHITE</span></label>
                    <label class="image-option-label"><input type="checkbox" name="cores_armario" value="Rosa Fúcsia"><div class="image-option-content"><div class="color-swatch" style="background-color: #D85799;"></div></div><span class="option-name">ROSA FÚCSIA</span></label>
                    <label class="image-option-label"><input type="checkbox" name="cores_armario" value="Rosa Pink"><div class="image-option-content"><div class="color-swatch" style="background-color: #E682A8;"></div></div><span class="option-name">ROSA PINK</span></label>
                    <label class="image-option-label"><input type="checkbox" name="cores_armario" value="Rosê"><div class="image-option-content"><div class="color-swatch" style="background-color: #DAB9B6;"></div></div><span class="option-name">ROSÊ</span></label>
                    <label class="image-option-label"><input type="checkbox" name="cores_armario" value="Terracota"><div class="image-option-content"><div class="color-swatch" style="background-color: #C96A45;"></div></div><span class="option-name">TERRACOTA</span></label>
                    <label class="image-option-label"><input type="checkbox" name="cores_armario" value="Verde Bandeira"><div class="image-option-content"><div class="color-swatch" style="background-color: #2F8856;"></div></div><span class="option-name">VERDE BANDEIRA</span></label>
                    <label class="image-option-label"><input type="checkbox" name="cores_armario" value="Verde Claro (Cidreira)"><div class="image-option-content"><div class="color-swatch" style="background-color: #CED66E;"></div></div><span class="option-name">VERDE CLARO (CIDREIRA)</span></label>
                    <label class="image-option-label"><input type="checkbox" name="cores_armario" value="Verde Esmeralda"><div class="image-option-content"><div class="color-swatch" style="background-color: #499A75;"></div></div><span class="option-name">VERDE ESMERALDA</span></label>
                    <label class="image-option-label"><input type="checkbox" name="cores_armario" value="Verde Oliva"><div class="image-option-content"><div class="color-swatch" style="background-color: #8C8C4E;"></div></div><span class="option-name">VERDE OLIVA</span></label>
                    <label class="image-option-label"><input type="checkbox" name="cores_armario" value="Vinho (Bordô)"><div class="image-option-content"><div class="color-swatch" style="background-color: #8C3345;"></div></div><span class="option-name">VINHO (BORDÔ)</span></label>
                    <label class="image-option-label"><input type="checkbox" name="cores_armario" value="Outro" data-outro-target="#outroCoresGosta"><div class="image-option-content"><img src="https://i.imgur.com/DZ55G8P.png" class="other-option" alt="Outra cor"></div><span class="option-name">OUTRA(S)</span></label>
                </div>
                 <div id="outroCoresGosta" class="outro-input-container hidden">
                  <input type="text" name="cores_armario_outro" placeholder="Por favor, especifique a cor" />
                </div>
              </div>
              <div class="field field-spaced">
                <span class="question">Quais cores você <strong class="nao-gosta-label">NÃO GOSTA</strong> de usar?<span class="required-asterisk">*</span></span>
                <p class="legend">Ou seja, quais dessas você não se sente bem, não tem essa cor, não usa ou, acha que não te favorece?</p>
                <div class="image-grid" role="group" id="naoGostaGrid">
                    <label class="image-option-label"><input type="checkbox" name="cores_nao_gosta" value="Preto"><div class="image-option-content"><div class="color-swatch" style="background-color: #222222;"></div></div><span class="option-name">PRETO</span></label>
                    <label class="image-option-label"><input type="checkbox" name="cores_nao_gosta" value="Branco"><div class="image-option-content"><div class="color-swatch" style="background-color: #FFFFFF; border: 1px solid #ddd;"></div></div><span class="option-name">BRANCO</span></label>
                    <label class="image-option-label"><input type="checkbox" name="cores_nao_gosta" value="Amarelo Gema"><div class="image-option-content"><div class="color-swatch" style="background-color: #F8D568;"></div></div><span class="option-name">AMARELO GEMA</span></label>
                    <label class="image-option-label"><input type="checkbox" name="cores_nao_gosta" value="Amarelo Lima"><div class="image-option-content"><div class="color-swatch" style="background-color: #D4DD4F;"></div></div><span class="option-name">AMARELO LIMA</span></label>
                    <label class="image-option-label"><input type="checkbox" name="cores_nao_gosta" value="Amarelo Mostarda"><div class="image-option-content"><div class="color-swatch" style="background-color: #DDAF27;"></div></div><span class="option-name">AMARELO MOSTARDA</span></label>
                    <label class="image-option-label"><input type="checkbox" name="cores_nao_gosta" value="Azul Claro (Celeste)"><div class="image-option-content"><div class="color-swatch" style="background-color: #A4C8E2;"></div></div><span class="option-name">AZUL CLARO (CELESTE)</span></label>
                    <label class="image-option-label"><input type="checkbox" name="cores_nao_gosta" value="Azul Marinho"><div class="image-option-content"><div class="color-swatch" style="background-color: #2F3E58;"></div></div><span class="option-name">AZUL MARINHO</span></label>
                    <label class="image-option-label"><input type="checkbox" name="cores_nao_gosta" value="Azul Royal"><div class="image-option-content"><div class="color-swatch" style="background-color: #3155A3;"></div></div><span class="option-name">AZUL ROYAL</span></label>
                    <label class="image-option-label"><input type="checkbox" name="cores_nao_gosta" value="Bege (Areia)"><div class="image-option-content"><div class="color-swatch" style="background-color: #D6C6B2;"></div></div><span class="option-name">BEGE (AREIA)</span></label>
                    <label class="image-option-label"><input type="checkbox" name="cores_nao_gosta" value="Cinza"><div class="image-option-content"><div class="color-swatch" style="background-color: #A0A0A0;"></div></div><span class="option-name">CINZA</span></label>
                    <label class="image-option-label"><input type="checkbox" name="cores_nao_gosta" value="Laranja"><div class="image-option-content"><div class="color-swatch" style="background-color: #F37A23;"></div></div><span class="option-name">LARANJA</span></label>
                    <label class="image-option-label"><input type="checkbox" name="cores_nao_gosta" value="Lilás"><div class="image-option-content"><div class="color-swatch" style="background-color: #C9A9C9;"></div></div><span class="option-name">LILÁS</span></label>
                    <label class="image-option-label"><input type="checkbox" name="cores_nao_gosta" value="Marrom (Caramelo)"><div class="image-option-content"><div class="color-swatch" style="background-color: #AF7B46;"></div></div><span class="option-name">MARROM (CARAMELO)</span></label>
                    <label class="image-option-label"><input type="checkbox" name="cores_nao_gosta" value="Off White"><div class="image-option-content"><div class="color-swatch" style="background-color: #F3EFE7; border: 1px solid #ddd;"></div></div><span class="option-name">OFF WHITE</span></label>
                    <label class="image-option-label"><input type="checkbox" name="cores_nao_gosta" value="Rosa Fúcsia"><div class="image-option-content"><div class="color-swatch" style="background-color: #D85799;"></div></div><span class="option-name">ROSA FÚCSIA</span></label>
                    <label class="image-option-label"><input type="checkbox" name="cores_nao_gosta" value="Rosa Pink"><div class="image-option-content"><div class="color-swatch" style="background-color: #E682A8;"></div></div><span class="option-name">ROSA PINK</span></label>
                    <label class="image-option-label"><input type="checkbox" name="cores_nao_gosta" value="Rosê"><div class="image-option-content"><div class="color-swatch" style="background-color: #DAB9B6;"></div></div><span class="option-name">ROSÊ</span></label>
                    <label class="image-option-label"><input type="checkbox" name="cores_nao_gosta" value="Terracota"><div class="image-option-content"><div class="color-swatch" style="background-color: #C96A45;"></div></div><span class="option-name">TERRACOTA</span></label>
                    <label class="image-option-label"><input type="checkbox" name="cores_nao_gosta" value="Verde Bandeira"><div class="image-option-content"><div class="color-swatch" style="background-color: #2F8856;"></div></div><span class="option-name">VERDE BANDEIRA</span></label>
                    <label class="image-option-label"><input type="checkbox" name="cores_nao_gosta" value="Verde Claro (Cidreira)"><div class="image-option-content"><div class="color-swatch" style="background-color: #CED66E;"></div></div><span class="option-name">VERDE CLARO (CIDREIRA)</span></label>
                    <label class="image-option-label"><input type="checkbox" name="cores_nao_gosta" value="Verde Esmeralda"><div class="image-option-content"><div class="color-swatch" style="background-color: #499A75;"></div></div><span class="option-name">VERDE ESMERALDA</span></label>
                    <label class="image-option-label"><input type="checkbox" name="cores_nao_gosta" value="Verde Oliva"><div class="image-option-content"><div class="color-swatch" style="background-color: #8C8C4E;"></div></div><span class="option-name">VERDE OLIVA</span></label>
                    <label class="image-option-label"><input type="checkbox" name="cores_nao_gosta" value="Vinho (Bordô)"><div class="image-option-content"><div class="color-swatch" style="background-color: #8C3345;"></div></div><span class="option-name">VINHO (BORDÔ)</span></label>
                    <label class="image-option-label"><input type="checkbox" name="cores_nao_gosta" value="Outro" data-outro-target="#outroCoresNaoGosta"><div class="image-option-content"><img src="https://i.imgur.com/DZ55G8P.png" class="other-option" alt="Outra cor"></div><span class="option-name">OUTRA(S)</span></label>
                </div>
                 <div id="outroCoresNaoGosta" class="outro-input-container hidden">
                  <input type="text" name="cores_nao_gosta_outro" placeholder="Por favor, especifique a cor" />
                </div>
                <div id="colorConflictError" class="error-message hidden">Você marcou a mesma cor em "GOSTA" e "NÃO GOSTA". Por favor, verifique suas respostas.</div>
              </div>
              <div class="field">
                <span class="question">Quais metais você costuma usar em acessórios?<span class="required-asterisk">*</span></span>
                <div class="options" role="group">
                  <label class="option"><input type="checkbox" name="metais_acessorios" value="Dourado" /><span>Dourado</span></label>
                  <label class="option"><input type="checkbox" name="metais_acessorios" value="Prateado" /><span>Prateado</span></label>
                  <label class="option"><input type="checkbox" name="metais_acessorios" value="Rosé" /><span>Rosé</span></label>
                  <label class="option"><input type="checkbox" name="metais_acessorios" value="Não costumo usar acessórios" /><span>Não costumo usar acessórios</span></label>
                  <label class="option"><input type="checkbox" name="metais_acessorios" value="Outro" data-outro-target="#outroMetais" /><span>Outro</span></label>
                </div>
                <div id="outroMetais" class="outro-input-container hidden">
                  <input type="text" name="metais_acessorios_outro" placeholder="Por favor, especifique" />
                </div>
              </div>
              <div class="field">
                <label class="question" for="batom_favorito">Qual nome do seu batom favorito, que você mais usa no dia a dia?</label>
                <p class="legend">Se não souber, descreva as cores que gosta (vermelhos, nudes, rosa matte, etc)</p>
                <input id="batom_favorito" name="batom_favorito" type="text" placeholder="Exemplo: Soar - MAC" />
              </div>
            </div>
            
            <!-- PÁGINA 3: Características Físicas -->
            <div class="form-page hidden" data-page="3">
              <h2 class="subtitle">Suas características físicas</h2>
              <p class="legend">Informe se houve algum procedimento estético ou alteração recente na pele que possa influenciar o resultado da análise.</p>
              
              <div class="field">
                <span class="question">Qual é a cor natural dos seus olhos?<span class="required-asterisk">*</span></span>
                <div class="image-grid" role="radiogroup">
                  <label class="image-option-label"><input type="radio" name="olhos_cor_natural" value="Castanho Escuro" required><div class="image-option-content"><img src="https://i.imgur.com/eDkC9V5.png" alt="Olhos Castanho Escuro"></div><span class="option-name">Castanho Escuro</span></label>
                  <label class="image-option-label"><input type="radio" name="olhos_cor_natural" value="Castanho Médio"><div class="image-option-content"><img src="https://i.imgur.com/Qm74ZDo.png" alt="Olhos Castanho Médio"></div><span class="option-name">Castanho Médio</span></label>
                  <label class="image-option-label"><input type="radio" name="olhos_cor_natural" value="Castanho Claro"><div class="image-option-content"><img src="https://i.imgur.com/hiQbSlh.png" alt="Olhos Castanho Claro"></div><span class="option-name">Castanho Claro</span></label>
                  <label class="image-option-label"><input type="radio" name="olhos_cor_natural" value="Avelã"><div class="image-option-content"><img src="https://i.imgur.com/tDwdjjr.png" alt="Olhos Avelã"></div><span class="option-name">Avelã</span></label>
                  <label class="image-option-label"><input type="radio" name="olhos_cor_natural" value="Âmbar"><div class="image-option-content"><img src="https://i.imgur.com/1xnPBBF.png" alt="Olhos Âmbar"></div><span class="option-name">Âmbar</span></label>
                  <label class="image-option-label"><input type="radio" name="olhos_cor_natural" value="Verde"><div class="image-option-content"><img src="https://i.imgur.com/C6vdAw1.png" alt="Olhos Verdes"></div><span class="option-name">Verde</span></label>
                  <label class="image-option-label"><input type="radio" name="olhos_cor_natural" value="Azul"><div class="image-option-content"><img src="https://i.imgur.com/fFbXS1i.png" alt="Olhos Azuis"></div><span class="option-name">Azul</span></label>
                  <label class="image-option-label"><input type="radio" name="olhos_cor_natural" value="Cinza"><div class="image-option-content"><img src="https://i.imgur.com/ZxZGIsS.png" alt="Olhos Cinza"></div><span class="option-name">Cinza</span></label>
                  <label class="image-option-label"><input type="radio" name="olhos_cor_natural" value="Outro" data-outro-target="#outroOlhosCor"><div class="image-option-content"><img src="https://i.imgur.com/DZ55G8P.png" class="other-option" alt="Outra cor de olhos ou não sei dizer"></div><span class="option-name">Outro / Não sei</span></label>
                </div>
                 <div id="outroOlhosCor" class="outro-input-container hidden">
                  <input type="text" name="olhos_cor_natural_outro" placeholder="Por favor, especifique a cor" />
                </div>
              </div>
              <div class="field field-spaced">
                  <span class="question">Qual é a cor natural dos seus cabelos?<span class="required-asterisk">*</span></span>
                  <div class="image-grid" role="radiogroup">
                      <label class="image-option-label"><input type="radio" name="cabelo_cor_natural" value="Preto" required><div class="image-option-content"><img src="https://i.imgur.com/pfu1Hlq.png" alt="Cabelo Preto"></div><span class="option-name">Preto</span></label>
                      <label class="image-option-label"><input type="radio" name="cabelo_cor_natural" value="Castanho Escuro"><div class="image-option-content"><img src="https://i.imgur.com/cJIEP0f.png" alt="Cabelo Castanho Escuro"></div><span class="option-name">Castanho Escuro</span></label>
                      <label class="image-option-label"><input type="radio" name="cabelo_cor_natural" value="Castanho Médio"><div class="image-option-content"><img src="https://i.imgur.com/0m0Dhu4.png" alt="Cabelo Castanho Médio"></div><span class="option-name">Castanho Médio</span></label>
                      <label class="image-option-label"><input type="radio" name="cabelo_cor_natural" value="Castanho Claro"><div class="image-option-content"><img src="https://i.imgur.com/tc0yc6I.png" alt="Cabelo Castanho Claro"></div><span class="option-name">Castanho Claro</span></label>
                      <label class="image-option-label"><input type="radio" name="cabelo_cor_natural" value="Loiro Escuro"><div class="image-option-content"><img src="https://i.imgur.com/8N2Khix.png" alt="Cabelo Loiro Escuro"></div><span class="option-name">Loiro Escuro</span></label>
                      <label class="image-option-label"><input type="radio" name="cabelo_cor_natural" value="Loiro Médio"><div class="image-option-content"><img src="https://i.imgur.com/Zndfo8P.png" alt="Cabelo Loiro Médio"></div><span class="option-name">Loiro Médio</span></label>
                      <label class="image-option-label"><input type="radio" name="cabelo_cor_natural" value="Loiro Claro"><div class="image-option-content"><img src="https://i.imgur.com/PH5TbM0.png" alt="Cabelo Loiro Claro"></div><span class="option-name">Loiro Claro</span></label>
                      <label class="image-option-label"><input type="radio" name="cabelo_cor_natural" value="Ruivo"><div class="image-option-content"><img src="https://i.imgur.com/Dk0464G.png" alt="Cabelo Ruivo"></div><span class="option-name">Ruivo</span></label>
                      <label class="image-option-label"><input type="radio" name="cabelo_cor_natural" value="Outro" data-outro-target="#outroCabeloCor"><div class="image-option-content"><img src="https://i.imgur.com/DZ55G8P.png" class="other-option" alt="Outra cor de cabelo ou não sei dizer"></div><span class="option-name">Outro / Não sei</span></label>
                  </div>
                  <div id="outroCabeloCor" class="outro-input-container hidden">
                    <input type="text" name="cabelo_cor_natural_outro" placeholder="Por favor, especifique" />
                  </div>
              </div>
              <div class="field">
                <span class="question">Seu cabelo ATUAL está natural ou possui coloração?<span class="required-asterisk">*</span></span>
                <div id="coloracaoOptions" class="options" role="group">
                  <label class="option"><input type="radio" name="cabelo_tem_coloracao" value="Natural" required/><span>Está totalmente na cor natural.</span></label>
                  <label class="option"><input type="radio" name="cabelo_tem_coloracao" value="Coloração desde a raiz" /><span>Tem coloração, desde a raiz até as pontas.</span></label>
                  <label class="option"><input type="radio" name="cabelo_tem_coloracao" value="Coloração sem raiz" /><span>Tem coloração, mas não na raiz.</span></label>
                  <label class="option"><input type="radio" name="cabelo_tem_coloracao" value="Outro" data-outro-target="#outroCabeloColoracao" /><span>Outro</span></label>
                </div>
                <div id="outroCabeloColoracao" class="outro-input-container hidden">
                  <input type="text" name="cabelo_tem_coloracao_outro" placeholder="Por favor, especifique" />
                </div>
              </div>
              <div class="field" id="cabeloCorAtualField">
                <label class="question" for="cabelo_cor_atual">Qual é a cor atual do seu cabelo?<span class="required-asterisk">*</span></label>
                <p class="legend">Exemplo: luzes claras, ruivo, etc.</p>
                <input id="cabelo_cor_atual" name="cabelo_cor_atual" type="text" placeholder="Descreva a cor atual" />
              </div>
              <div class="field">
                <span class="question">Como sua pele reage à exposição solar?<span class="required-asterisk">*</span></span>
                <div class="options" role="group">
                  <label class="option"><input type="radio" name="pele_sol" value="Minha pele queima facilmente e raramente bronzeia, ficando vermelha e sensível após a exposição." required /><span>Minha pele queima facilmente e raramente bronzeia, ficando vermelha e sensível após a exposição.</span></label>
                  <label class="option"><input type="radio" name="pele_sol" value="Minha pele fica vermelha no início, mas depois escurece e pega um tom de bronze." /><span>Minha pele fica vermelha no início, mas depois escurece e pega um tom de bronze.</span></label>
                  <label class="option"><input type="radio" name="pele_sol" value="Minha pele bronzeia com facilidade, adquirindo um tom dourado, e raramente fica vermelha." /><span>Minha pele bronzeia com facilidade, adquirindo um tom dourado, e raramente fica vermelha.</span></label>
                  <label class="option"><input type="radio" name="pele_sol" value="Outro" data-outro-target="#outroPeleSol" /><span>Outro</span></label>
                </div>
                <div id="outroPeleSol" class="outro-input-container hidden">
                  <input type="text" name="pele_sol_outro" placeholder="Por favor, especifique" />
                </div>
              </div>
              <div class="field">
                <label class="question" for="pele_alteracao">Alguma alteração significativa na pele nos últimos 30 dias?</label>
                <p class="legend">Exemplo: limpeza de pele, peeling, etc.</p>
                <textarea id="pele_alteracao" name="pele_alteracao" rows="2" placeholder="Descreva aqui"></textarea>
              </div>
              <div class="field">
                <label class="question" for="rosto_disfarcar">Existe algo em seu rosto que você gostaria de disfarçar ou amenizar?</label>
                <p class="legend">Exemplo: olheiras, melasma, etc.</p>
                <textarea id="rosto_disfarcar" name="rosto_disfarcar" rows="2" placeholder="Conte aqui"></textarea>
              </div>
              <div class="field">
                <span class="question">Qual destes procedimentos você tem atualmente?<span class="required-asterisk">*</span></span>
                <div class="options" role="group">
                  <label class="option"><input type="checkbox" name="procedimentos" value="Micropigmentação nos lábios" /><span>Micropigmentação nos lábios</span></label>
                  <label class="option"><input type="checkbox" name="procedimentos" value="Micropigmentação nas sobrancelhas" /><span>Micropigmentação nas sobrancelhas (ou outra técnica)</span></label>
                  <label class="option"><input type="checkbox" name="procedimentos" value="Micropigmentação na linha d'água" /><span>Micropigmentação na linha d'água (delineador)</span></label>
                  <label class="option"><input type="checkbox" name="procedimentos" value="Extensão de cílios" /><span>Extensão de cílios</span></label>
                  <label class="option"><input type="checkbox" name="procedimentos" value="Nenhuma das alternativas" /><span>Nenhuma das alternativas</span></label>
                  <label class="option"><input type="checkbox" name="procedimentos" value="Outro" data-outro-target="#outroProcedimentos" /><span>Outro</span></label>
                </div>
                <div id="outroProcedimentos" class="outro-input-container hidden">
                  <input type="text" name="procedimentos_outro" placeholder="Por favor, especifique" />
                </div>
              </div>
            </div>
            
            <!-- PÁGINA 4: Encerramento -->
            <div class="form-page hidden" data-page="4">
              <h2 class="subtitle">Encerramento</h2>
              <p class="legend">Estamos quase no fim. Só mais algumas perguntas.</p>
              <div class="field">
                <span class="question">É a primeira vez que você faz análise de coloração pessoal?<span class="required-asterisk">*</span></span>
                <div class="options" role="group">
                  <label class="option"><input type="radio" name="primeira_vez" value="É a primeira vez que faço coloração pessoal." required /><span>É a primeira vez que faço coloração pessoal.</span></label>
                  <label class="option"><input type="radio" name="primeira_vez" value="Já fiz coloração anteriormente com outra profissional." /><span>Já fiz coloração anteriormente com outra profissional.</span></label>
                  <label class="option"><input type="radio" name="primeira_vez" value="Já fiz coloração em sites e/ou aplicativos com IA." /><span>Já fiz coloração em sites e/ou aplicativos com IA.</span></label>
                  <label class="option"><input type="radio" name="primeira_vez" value="Outro" data-outro-target="#outroPrimeiraVez" /><span>Outro</span></label>
                </div>
                <div id="outroPrimeiraVez" class="outro-input-container hidden">
                  <input type="text" name="primeira_vez_outro" placeholder="Por favor, especifique" />
                </div>
              </div>
              <div class="field">
                <span class="question">O quanto você sabe sobre coloração pessoal?<span class="required-asterisk">*</span></span>
                <div class="options" role="group">
                  <label class="option"><input type="radio" name="quanto_sabe" value="Não sei quase nada, sou iniciante." required/><span>Não sei quase nada, sou iniciante.</span></label>
                  <label class="option"><input type="radio" name="quanto_sabe" value="Já ouvi falar e conheço o básico." /><span>Já ouvi falar e conheço o básico.</span></label>
                  <label class="option"><input type="radio" name="quanto_sabe" value="Já pesquisei bastante sobre o assunto." /><span>Já pesquisei bastante sobre o assunto.</span></label>
                  <label class="option"><input type="radio" name="quanto_sabe" value="Outro" data-outro-target="#outroQuantoSabe" /><span>Outro</span></label>
                </div>
                 <div id="outroQuantoSabe" class="outro-input-container hidden">
                  <input type="text" name="quanto_sabe_outro" placeholder="Por favor, especifique" />
                </div>
              </div>
               <div class="field">
                <label class="question" for="suspeita_cartela">Você suspeita e/ou se identifica de alguma cartela específica? Se sim, porque?</label>
                <textarea id="suspeita_cartela" name="suspeita_cartela" rows="3" placeholder="Conte aqui"></textarea>
              </div>
              <div class="field">
                <span class="question">Você é consultora de imagem ou tem interesse em trabalhar nessa área?<span class="required-asterisk">*</span></span>
                <div class="options" role="group">
                  <label class="option"><input type="radio" name="consultora_interesse" value="Não sou / não tenho interesse" required /><span>Não sou / não tenho interesse</span></label>
                  <label class="option"><input type="radio" name="consultora_interesse" value="Sou consultora de imagem" /><span>Sou consultora de imagem</span></label>
                  <label class="option"><input type="radio" name="consultora_interesse" value="Outro" data-outro-target="#outroConsultora" /><span>Outro</span></label>
                </div>
                <div id="outroConsultora" class="outro-input-container hidden">
                  <input type="text" name="consultora_interesse_outro" placeholder="Por favor, especifique" />
                </div>
              </div>
               <div class="field">
                <label class="question" for="observacoes">Outras observações:</label>
                <textarea id="observacoes" name="observacoes" rows="3" placeholder="Escreva aqui se houver algo mais que queira adicionar."></textarea>
              </div>
            </div>
        </div>

        <!-- BOTÕES DE NAVEGAÇÃO -->
        <div class="navigation-buttons">
            <button id="backBtnNav" type="button" class="primary outline hidden">VOLTAR</button>
            <button id="nextBtnNav" type="button" class="primary">PRÓXIMO</button>
        </div>
    </form>

    <!-- PÁGINA DE RESULTADO -->
    <section id="resultPage" class="card hidden" aria-live="polite">
       <h2 class="subtitle">SEU FORMULÁRIO FOI GERADO!</h2>
      <p class="legend">Tudo pronto! Agora clique no botão <strong>COPIAR RESPOSTAS</strong> para copiar o texto abaixo e me envie no WhatsApp.</p>
      <pre id="resultText"> </pre>
      <div class="navigation-buttons result-buttons" style="border-top: none; padding-top: 12px;">
        <button id="copyBtn" class="primary outline" type="button">COPIAR RESPOSTAS</button>
        <a id="whatsBtn" class="primary" href="https://wa.me/5534998611525" target="_blank" rel="noopener">ABRIR WHATSAPP</a>
      </div>
       <div style="text-align: center; margin-top: 12px;">
         <span id="copyMsg" class="legend" role="status"></span>
      </div>
      <div style="margin-top: 10px; text-align: center;">
        <button id="editBtn" class="link" type="button">Voltar e editar</button>
      </div>
    </section>
  </main>
  
  <footer class="main-footer">
      <p>COPYRIGHT © TODOS OS DIREITOS RESERVADOS 2025</p>
      <p><strong>GABRIELA MACEDO | @gabrielamacedocores</strong></p>
      <p>CNPJ 55.495.465/0001-52</p>
  </footer>


  <script>
    const form = document.getElementById('quizForm');
    const resultPage = document.getElementById('resultPage');
    const resultText = document.getElementById('resultText');
    const copyBtn = document.getElementById('copyBtn');
    const whatsBtn = document.getElementById('whatsBtn');
    const copyMsg = document.getElementById('copyMsg');
    const editBtn = document.getElementById('editBtn');
    
    const pagesContainer = document.getElementById('pagesContainer');
    const pages = document.querySelectorAll('.form-page');
    const progressBar = document.getElementById('progressBar');
    const progressText = document.getElementById('progressText');
    const backBtnNav = document.getElementById('backBtnNav');
    const nextBtnNav = document.getElementById('nextBtnNav');
    const totalPages = pages.length;
    let currentPage = 1;

    const formDraftKey = 'form-coloracao-pessoal-draft';
    
    // Funções de utilidade (rascunho, etc.)
    function saveDraft() {
        const data = new FormData(form);
        const entries = {};
        for (const [key, value] of data.entries()) {
            if (entries[key]) {
                if (!Array.isArray(entries[key])) entries[key] = [entries[key]];
                entries[key].push(value);
            } else {
                entries[key] = value;
            }
        }
        localStorage.setItem(formDraftKey, JSON.stringify(entries));
    }
    function loadDraft() {
        const savedData = localStorage.getItem(formDraftKey);
        if (!savedData) return;
        const data = JSON.parse(savedData);
        for (const key in data) {
            const element = form.elements[key];
            if (!element) continue;
            const value = data[key];
            if (element.constructor === RadioNodeList) {
                element.forEach(radio => { if (radio.value === value) radio.checked = true; });
            } else if (element.length && element[0].type === 'checkbox') {
                const values = Array.isArray(value) ? value : [value];
                Array.from(element).forEach(checkbox => { if (values.includes(checkbox.value)) checkbox.checked = true; });
            } else {
                element.value = value;
            }
        }
        updateAllOutroFields();
    }
    function updateAllOutroFields() {
        const activeTargets = new Set();
        form.querySelectorAll('input[type="radio"]:checked, input[type="checkbox"]:checked').forEach(input => {
            if (input.dataset.outroTarget) activeTargets.add(input.dataset.outroTarget);
        });
        form.querySelectorAll('select[data-outro-select-target]').forEach(select => {
            if (select.value === 'Outro') activeTargets.add(select.dataset.outroSelectTarget);
        });
        document.querySelectorAll('.outro-input-container').forEach(container => {
            const containerId = `#${container.id}`;
            const shouldBeVisible = activeTargets.has(containerId);
            container.classList.toggle('hidden', !shouldBeVisible);
            const inputField = container.querySelector('input, textarea');
            if (inputField && !shouldBeVisible) inputField.value = '';
        });
    }

    function serializeForm(formEl) {
        const fd = new FormData(formEl);
        const groups = {};
        for (const [key, value] of fd.entries()) {
            if (value.trim() !== "") {
                if (!groups[key]) groups[key] = [];
                groups[key].push(value);
            }
        }

        const lines = ['ANÁLISE DE COLORAÇÃO PESSOAL (ONLINE) - FORMULÁRIO', ''];

        // Bloco 1
        if (groups.nome) lines.push(groups.nome[0]);
        if (groups.instagram) {
            let username = groups.instagram[0].trim().replace(/^@/, '').replace(/^(https?:\/\/)?(www\.)?instagram\.com\//, '');
            lines.push(`https://www.instagram.com/${username}`);
        }
        if (groups.email) lines.push(groups.email[0]);
        if (groups.whatsapp) lines.push(groups.whatsapp[0]);
        if (groups.genero) {
            let value = groups.genero[0];
            if (value === 'Outro' && groups.genero_outro) value = groups.genero_outro[0];
            lines.push(value);
        }
        if (groups.faixa_etaria) lines.push(groups.faixa_etaria[0]);
        lines.push('');

        // Bloco 2
        if(groups.pref_cores_ousadia) {
            let value = groups.pref_cores_ousadia[0];
            if (value === 'Outro' && groups.pref_cores_ousadia_outro) value = groups.pref_cores_ousadia_outro[0];
            lines.push(`SOBRE CORES: ${value}`);
        }
        
        let gosta = [];
        if(groups.cores_armario) gosta.push(...groups.cores_armario.filter(v => v !== 'Outro'));
        if(groups.cores_armario_outro) gosta.push(groups.cores_armario_outro[0]);
        if (gosta.length > 0) lines.push(`GOSTA: ${gosta.join(', ')}`);
        
        let naoGosta = [];
        if(groups.cores_nao_gosta) naoGosta.push(...groups.cores_nao_gosta.filter(v => v !== 'Outro'));
        if(groups.cores_nao_gosta_outro) naoGosta.push(groups.cores_nao_gosta_outro[0]);
        if (naoGosta.length > 0) lines.push(`NÃO GOSTA: ${naoGosta.join(', ')}`);
        
        if (groups.metais_acessorios) {
            let value = groups.metais_acessorios.filter(v => v !== 'Outro');
            if (groups.metais_acessorios.includes('Outro') && groups.metais_acessorios_outro) {
                value.push(groups.metais_acessorios_outro[0]);
            }
            if (value.length > 0) lines.push(`METAIS: ${value.join(', ')}`);
        }

        lines.push('');
        
        // Bloco 3
        const olhos = groups.olhos_cor_natural_outro ? groups.olhos_cor_natural_outro[0] : (groups.olhos_cor_natural ? groups.olhos_cor_natural[0] : null);
        if(olhos && olhos !== 'Outro') lines.push(`COR DOS OLHOS: ${olhos}`);

        const cabeloNatural = groups.cabelo_cor_natural_outro ? groups.cabelo_cor_natural_outro[0] : (groups.cabelo_cor_natural ? groups.cabelo_cor_natural[0] : null);
        if(cabeloNatural && cabeloNatural !== 'Outro') lines.push(`CABELO NATURAL: ${cabeloNatural}`);
        
        const cabeloColoracaoStatus = groups.cabelo_tem_coloracao ? groups.cabelo_tem_coloracao[0] : null;
        if (cabeloColoracaoStatus === 'Natural') {
            lines.push('CABELO ATUAL: Natural');
        } else if (groups.cabelo_cor_atual) {
            lines.push(`CABELO ATUAL: ${groups.cabelo_cor_atual[0]}`);
        } else if (cabeloColoracaoStatus === 'Outro' && groups.cabelo_tem_coloracao_outro) {
             lines.push(`CABELO ATUAL: ${groups.cabelo_tem_coloracao_outro[0]}`);
        } else if (cabeloColoracaoStatus) {
             lines.push(`CABELO ATUAL: ${cabeloColoracaoStatus}`);
        }
        
        
        const pele = groups.pele_sol_outro ? groups.pele_sol_outro[0] : (groups.pele_sol ? groups.pele_sol[0] : null);
        if (pele && pele !== 'Outro') lines.push(`PELE: ${pele}`);

        if (groups.procedimentos && groups.procedimentos.length > 0) {
            let value = groups.procedimentos.filter(v => v !== 'Outro' && v !== 'Nenhuma das alternativas');
            if (groups.procedimentos.includes('Outro') && groups.procedimentos_outro) value.push(groups.procedimentos_outro[0]);
            if (value.length > 0) lines.push(`PROCEDIMENTOS: ${value.join(', ')}`);
        }


        // Bloco 4
        let observacoes = [];
        if (groups.pele_alteracao) observacoes.push(`- ${groups.pele_alteracao[0]} (sobre a alteração na pele)`);
        if (groups.rosto_disfarcar) observacoes.push(`- ${groups.rosto_disfarcar[0]} (sobre disfarçar)`);
        if (groups.observacoes) observacoes.push(`- ${groups.observacoes[0]}`);

        if (observacoes.length > 0) {
            lines.push('');
            lines.push('OBSERVAÇÕES:');
            lines.push(...observacoes);
        }
        
        lines.push('');

        // Bloco 5
        if (groups.suspeita_cartela) {
             lines.push('Você suspeita e/ou se identifica de alguma cartela específica? Se sim, porque?');
             lines.push(groups.suspeita_cartela[0]);
             lines.push('');
        }

        if (groups.primeira_vez) {
            lines.push('É a primeira vez que você faz análise de coloração pessoal?');
            let value = groups.primeira_vez[0];
            if (value === 'Outro' && groups.primeira_vez_outro) value = groups.primeira_vez_outro[0];
            if (value !== 'Outro') lines.push(value);
        }

        if (groups.quanto_sabe) {
            lines.push('');
            lines.push('O quanto você sabe sobre coloração pessoal?');
            let value = groups.quanto_sabe[0];
            if (value === 'Outro' && groups.quanto_sabe_outro) value = groups.quanto_sabe_outro[0];
            if (value !== 'Outro') lines.push(value);
        }
        
        if (groups.consultora_interesse) {
            lines.push('');
            lines.push('Você é consultora de imagem ou tem interesse em trabalhar nessa área?');
            let value = groups.consultora_interesse[0];
            if (value === 'Outro' && groups.consultora_interesse_outro) value = groups.consultora_interesse_outro[0];
            if (value !== 'Outro') lines.push(value);
        }


        return lines.filter(line => line !== null && line !== undefined).join('\n');
    }
    
    function showCopyMessage(success) {
        copyMsg.classList.remove('success', 'fade-out');
        void copyMsg.offsetWidth; 
        if (success) {
            copyMsg.textContent = 'Copiado! Agora é só colar no WhatsApp.';
            copyMsg.classList.add('success', 'fade-out');
        } else {
            copyMsg.textContent = 'Falha ao copiar. Selecione e copie manualmente.';
        }
    }
    function legacyCopy(text) {
        const textArea = document.createElement('textarea');
        textArea.value = text;
        textArea.style.position = 'fixed';
        textArea.style.opacity = '0';
        document.body.appendChild(textArea);
        textArea.focus();
        textArea.select();
        try {
            const success = document.execCommand('copy');
            showCopyMessage(success);
        } catch (err) {
            showCopyMessage(false);
        }
        document.body.removeChild(textArea);
    }
    function validateField(input) {
        const wrapper = input.closest('.field-wrapper');
        if(!wrapper) return;
        if(input.value.trim() === '') {
            wrapper.classList.remove('valid', 'invalid');
            input.classList.remove('is-valid', 'is-invalid');
            return;
        }
        if(input.checkValidity()){
            wrapper.classList.add('valid');
            wrapper.classList.remove('invalid');
            input.classList.add('is-valid');
            input.classList.remove('is-invalid');
        } else {
            wrapper.classList.add('invalid');
            wrapper.classList.remove('valid');
            input.classList.add('is-invalid');
            input.classList.remove('is-valid');
        }
    }

    function updateUI() {
        pages.forEach(page => page.classList.toggle('hidden', parseInt(page.dataset.page) !== currentPage));
        const progress = (currentPage / totalPages) * 100;
        progressBar.style.width = `${progress}%`;
        progressText.textContent = `PARTE 0${currentPage} / 0${totalPages}`;
        backBtnNav.classList.toggle('hidden', currentPage === 1);
        nextBtnNav.textContent = (currentPage === totalPages) ? 'GERAR RESPOSTAS' : 'PRÓXIMO';
    }
    
    function validateCurrentPage() {
        const currentPageElement = document.querySelector(`.form-page[data-page="${currentPage}"]`);
        const inputs = currentPageElement.querySelectorAll('[required]:not(:disabled)');
        let firstInvalidField = null;

        for (const input of inputs) {
            const field = input.closest('.field');
            if (!input.checkValidity()) {
                if (!firstInvalidField) {
                    firstInvalidField = field;
                }
            }
        }
        
        if (firstInvalidField) {
            firstInvalidField.scrollIntoView({ behavior: 'smooth', block: 'center' });
            firstInvalidField.classList.add('error-shake');
            setTimeout(() => firstInvalidField.classList.remove('error-shake'), 400);
            return false;
        }

        if (currentPage === 2) {
            if (!checkColorConflict()) return false;
            
            if (!Array.from(currentPageElement.querySelectorAll('input[name="cores_armario"]')).some(cb => cb.checked)) {
                const field = document.getElementById('gostaGrid').closest('.field');
                field.scrollIntoView({ behavior: 'smooth', block: 'center' });
                field.classList.add('error-shake');
                setTimeout(() => field.classList.remove('error-shake'), 400);
                return false;
            }

            if (!Array.from(currentPageElement.querySelectorAll('input[name="cores_nao_gosta"]')).some(cb => cb.checked)) {
                const field = document.getElementById('naoGostaGrid').closest('.field');
                field.scrollIntoView({ behavior: 'smooth', block: 'center' });
                field.classList.add('error-shake');
                setTimeout(() => field.classList.remove('error-shake'), 400);
                return false;
            }
            
            if (!Array.from(currentPageElement.querySelectorAll('input[name="metais_acessorios"]')).some(cb => cb.checked)) {
                 const field = currentPageElement.querySelector('input[name="metais_acessorios"]').closest('.field');
                 field.scrollIntoView({ behavior: 'smooth', block: 'center' });
                 field.classList.add('error-shake');
                 setTimeout(() => field.classList.remove('error-shake'), 400);
                 return false;
            }
        }
        
        if (currentPage === 3) {
             if (!Array.from(currentPageElement.querySelectorAll('input[name="procedimentos"]')).some(cb => cb.checked)) {
                 const field = currentPageElement.querySelector('input[name="procedimentos"]').closest('.field');
                 field.scrollIntoView({ behavior: 'smooth', block: 'center' });
                 field.classList.add('error-shake');
                 setTimeout(() => field.classList.remove('error-shake'), 400);
                 return false;
             }
        }

        return true;
    }

    function goToNextPage() {
        if (!validateCurrentPage()) return;
        if (currentPage < totalPages) {
            currentPage++;
            updateUI();
            window.scrollTo({ top: 0, behavior: 'smooth' });
        } else {
            nextBtnNav.innerHTML = '<div class="spinner"></div>';
            nextBtnNav.disabled = true;
            setTimeout(() => {
                const txt = serializeForm(form);
                resultText.textContent = txt;
                const encoded = encodeURIComponent(txt);
                whatsBtn.href = `https://wa.me/5534998611525?text=${encoded}`;
                form.classList.add('hidden');
                resultPage.classList.remove('hidden');
                localStorage.removeItem(formDraftKey);
                nextBtnNav.innerHTML = 'Gerar Respostas';
                nextBtnNav.disabled = false;
            }, 500);
        }
    }

    function goToPrevPage() {
        if (currentPage > 1) {
            currentPage--;
            updateUI();
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
    }
    
     function checkColorConflict() {
        const gosta = Array.from(document.querySelectorAll('input[name="cores_armario"]:checked')).map(c => c.value);
        const naoGosta = Array.from(document.querySelectorAll('input[name="cores_nao_gosta"]:checked')).map(c => c.value);
        const errorDiv = document.getElementById('colorConflictError');
        
        const conflictingColors = gosta.filter(cor => naoGosta.includes(cor) && cor !== 'Outro');

        if (conflictingColors.length > 0) {
            const colorText = conflictingColors.join(', ');
            let message = conflictingColors.length > 1 
                ? `Você marcou as mesmas cores (${colorText}) em "GOSTA" e "NÃO GOSTA". Por favor, verifique suas respostas.`
                : `Você marcou a mesma cor (${colorText}) em "GOSTA" e "NÃO GOSTA". Por favor, verifique sua resposta.`;
            errorDiv.textContent = message;
            errorDiv.classList.remove('hidden');
            return false; // Indica conflito
        } else {
            errorDiv.classList.add('hidden');
            return true; // Sem conflito
        }
    }

    const whatsappInput = document.getElementById('whatsapp');
    whatsappInput.addEventListener('input', (e) => {
        let value = e.target.value.replace(/\D/g, '');
        value = value.substring(0, 11);
        if (value.length > 10) {
            value = value.replace(/^(\d{2})(\d{5})(\d{4}).*/, '($1) $2-$3');
        } else if (value.length > 6) {
            value = value.replace(/^(\d{2})(\d{4})(\d{0,4}).*/, '($1) $2-$3');
        } else if (value.length > 2) {
            value = value.replace(/^(\d{2})(\d*)/, '($1) $2');
        } else if (value.length > 0) {
            value = `(${value}`;
        }
        e.target.value = value;
    });
    
    const coloracaoRadios = document.querySelectorAll('input[name="cabelo_tem_coloracao"]');
    const cabeloCorAtualField = document.getElementById('cabeloCorAtualField');
    const cabeloCorAtualInput = document.getElementById('cabelo_cor_atual');

    function toggleCabeloCorAtual() {
        const selected = document.querySelector('input[name="cabelo_tem_coloracao"]:checked');
        if (selected && selected.value === 'Natural') {
            cabeloCorAtualField.style.display = 'none';
            cabeloCorAtualInput.value = '';
            cabeloCorAtualInput.required = false;
        } else {
            cabeloCorAtualField.style.display = 'block';
            cabeloCorAtualInput.required = true;
        }
    }
    coloracaoRadios.forEach(radio => radio.addEventListener('change', toggleCabeloCorAtual));

    nextBtnNav.addEventListener('click', goToNextPage);
    backBtnNav.addEventListener('click', goToPrevPage);
    
    copyBtn.addEventListener('click', () => {
        const textToCopy = resultText.textContent.trim();
        if (navigator.clipboard && window.isSecureContext) {
            navigator.clipboard.writeText(textToCopy).then(() => showCopyMessage(true)).catch(() => legacyCopy(textToCopy));
        } else {
            legacyCopy(textToCopy);
        }
    });

    editBtn.addEventListener('click', () => {
        currentPage = 1;
        updateUI();
        form.classList.remove('hidden');
        resultPage.classList.add('hidden');
    });

    document.querySelectorAll('#instagram, #email, #whatsapp').forEach(input => {
        input.addEventListener('input', () => validateField(input));
    });

    form.addEventListener('input', (e) => {
        saveDraft();
        updateAllOutroFields();
        if (e.target.name === 'cores_armario' || e.target.name === 'cores_nao_gosta') {
            checkColorConflict();
        }
    });

    document.addEventListener('DOMContentLoaded', () => {
        loadDraft();
        updateUI();
        toggleCabeloCorAtual();

        document.querySelectorAll('select').forEach(select => {
            select.addEventListener('change', () => {
                if(select.value === "") {
                    select.classList.remove('selected');
                } else {
                    select.classList.add('selected');
                }
            });
             if(select.value === "") {
                select.classList.add('selected');
            }
        });
    });
  </script>
</body>
</html>

